---
title: JVM内存监控和分析工具
date: 2020-03-26
sidebar: false
tags:
 - JVM
 - 内存监控
categories:
 - Java
---

### 1. jps：显示当前所有java进程
```bash
usage: jps [-help]
       jps [-q] [-mlvV] [<hostid>]

Definitions:
    <hostid>:      <hostname>[:<port>]
```
- q 只显示pid，不显示class名称,jar文件名和传递给main方法的参数
- m 输出传递给main方法的参数，在嵌入式jvm上可能是null
- l 输出应用程序main class的完整package名或者应用程序的jar文件完整路径名
- v 输出传递给JVM的参数
- V 隐藏输出传递给JVM的参数

### 2. jstack：显示线程信息
```bash
Usage:
    jstack [-l] <pid>
        (to connect to running process) 连接活动线程
    jstack -F [-m] [-l] <pid>
        (to connect to a hung process) 连接阻塞线程
    jstack [-m] [-l] <executable> <core>
        (to connect to a core file) 连接dump的文件
    jstack [-m] [-l] [server_id@]<remote server IP or hostname>
        (to connect to a remote debug server) 连接远程服务器

Options:
    -F  to force a thread dump. Use when jstack <pid> does not respond (process is hung)
    -m  to print both java and native frames (mixed mode)
    -l  long listing. Prints additional information about locks
    -h or -help to print this help message
```
##### 使用样例请移步：[jstack 命令解析](https://www.jianshu.com/p/8d5782bc596e)

### 3. jmap：显示内存信息
```bash
Usage:
    jmap [option] <pid>
        (to connect to running process)
    jmap [option] <executable <core>
        (to connect to a core file)
    jmap [option] [server_id@]<remote server IP or hostname>
        (to connect to remote debug server)

where <option> is one of:
    <none>               to print same info as Solaris pmap
    -heap                to print java heap summary
    -histo[:live]        to print histogram of java object heap; if the "live"
                         suboption is specified, only count live objects
    -clstats             to print class loader statistics
    -finalizerinfo       to print information on objects awaiting finalization
    -dump:<dump-options> to dump java heap in hprof binary format
                         dump-options:
                           live         dump only live objects; if not specified,
                                        all objects in the heap are dumped.
                           format=b     binary format
                           file=<file>  dump heap to <file>
                         Example: jmap -dump:live,format=b,file=heap.bin <pid>
    -F                   force. Use with -dump:<dump-options> <pid> or -histo
                         to force a heap dump or histogram when <pid> does not
                         respond. The "live" suboption is not supported
                         in this mode.
    -h | -help           to print this help message
    -J<flag>             to pass <flag> directly to the runtime system
```

##### 参数
- option： 选项参数。
- pid： 需要打印配置信息的进程ID。
- executable： 产生核心dump的Java可执行文件。
- core： 需要打印配置信息的核心文件。
- server-id 可选的唯一id，如果相同的远程主机上运行了多台调试服务器，用此选项参数标识服务器。
- remote server IP or hostname 远程调试服务器的IP地址或主机名。
##### option：
- no option： 查看进程的内存映像信息,类似 Solaris pmap 命令。
- heap： 显示Java堆详细信息
- histo[:live]： 显示堆中对象的统计信息
- clstats：打印类加载器信息
- finalizerinfo： 显示在F-Queue队列等待Finalizer线程执行finalizer方法的对象
- dump:<dump-options>：生成堆转储快照
- F： 当-dump没有响应时，使用-dump或者-histo参数. 在这个模式下,live子参数无效.
- help：打印帮助信息
- J<flag>：指定传递给运行jmap的JVM的参数
##### 使用样例请移步：[jvm 性能调优工具之 jmap](https://www.jianshu.com/p/a4ad53179df3)

### 4. [PerfMa](https://console.perfma.com/)：在线分析线程dump和内存dump工具
