---
title: Docker 安装 kibana 和配置elasticsearch
date: 2020-05-13
sidebar: false
tags:
 - Docker
 - kibana
categories:
 - Docker
---

## 1. 拉取镜像，选择对应版本，默认latest，此处以 **6.7.2** 版本为例
```shell
docker pull kibana:6.7.2
```
## 2. 启动容器，进行端口映射，通过 **-v** 参数进行挂载，如配置文件，持久化，插件。
```shell
docker run -d --name kibana --hostname kibana -p 5601:5601 kibana:6.7.2
```

### 配置文件挂载，配置文件必须存在，部分版本挂载文件会报错：
```shell
-v D:/dockerMount/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml
```
kibana.yml 文件样例：
```yml
#
# ** THIS IS AN AUTO-GENERATED FILE **
#

# Default Kibana configuration for docker target
server.name: kibana
server.host: "0"
elasticsearch.hosts: [ "http://elasticsearch:9200" ]
xpack.monitoring.ui.container.elasticsearch.enabled: true
```

### 插件目录挂载: 
```
-v D:/dockerMount/kibana/plugins:/usr/share/kibana/plugins
```

## 3. 配置kibana.yml的elasticsearch地址
```shell
docker exec -it kibana bash
cd /usr/share/kibana/config
vi kibana.yml
# 修改 elasticsearch.hosts, 注意这个是docker内部网络，建议创建一个自定义 docker net, 然后使用主机名配置，进入elasticsearch查看hostname即可
# 配置文件挂载了的话，直接修改本地配置文件即可
```
