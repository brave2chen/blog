---
title: Docker 安装 elasticsearch 和 中文分词插件ik
date: 2020-05-13
sidebar: false
tags:
 - Docker
 - ElasticSearch
categories:
 - Docker
---

## 1. 拉取镜像，选择对应版本，默认latest，此处以 **6.7.2** 版本为例
```shell
docker pull elasticsearch:6.7.2
```
## 2. 启动容器，进行端口映射，通过 **-v** 参数进行挂载，如配置文件，持久化，插件。
```shell
docker run -d --name elasticsearch --hostname elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:6.7.2
```

### 配置文件挂载，配置文件必须存在：
```shell
-v D:/dockerMount/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml
```
elasticsearch.yml 文件样例：
```yml
cluster.name: "docker-cluster"
network.host: 0.0.0.0
```
### 持久化目录挂载：
```
-v D:/dockerMount/elasticsearch/data:/usr/share/elasticsearch/data
```
### 插件目录挂载: 
```
-v D:/dockerMount/elasticsearch/plugins:/usr/share/elasticsearch/plugins
```

## 3. 安装ik中文分词插件，参考https://github.com/medcl/elasticsearch-analysis-ik
### 在线安装方式
```shell
docker exec -it elasticsearch bash
cd /usr/share/elasticsearch
./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.7.2/elasticsearch-analysis-ik-6.7.2.zip
```
### 离线安装方式
- 下载：https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.7.2/elasticsearch-analysis-ik-6.7.2.zip
- 解压重命名目录为ik
- 复制到容器内插件目录/usr/share/elasticsearch/plugins下，挂载了插件目录的话，直接复制到插件挂载目录即可
### 安装完重启容器即可: ```docker restart elasticsearch```